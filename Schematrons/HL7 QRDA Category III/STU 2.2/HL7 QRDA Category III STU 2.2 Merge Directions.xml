<?xml version="1.0" encoding="UTF-8"?>
    
<mergeProfile xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  verboseDebug="true" summaryOnly="false" applyXSD="true" doValidation="true" stopOnError="false" >

    <!-- Merge directions file for HL7 QRDA Category III STU 2.2
         https://tracker.esacinc.com/browse/QRDA-527 -->
    
    <title>HL7 QRDA III STU 2.2</title>
    <version>1.0</version>
    
     <generatedFilename>
        c:/Development/QRDA-git/qrda/Schematrons/HL7 QRDA Category III/STU 2.2/Published/HL7 QRDA Category III STU 2.2 January 2019.sch
    </generatedFilename>
    <finalTestFilename>
       <!--  c:/Development/QRDA-git/qrda/Schematrons/HL7 QRDA Category III/STU 2.2/TestFiles/CDAR2_QRDAIII_R2_STU2_1_2017JUNE.xml --> 
    </finalTestFilename>
    
    <fileHeader>
    THIS SOFTWARE IS PROVIDED "AS IS" AND ANY EXPRESSED OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
    THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
    IN NO EVENT SHALL ESAC INC., OR ANY OF THEIR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE
    GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
    ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    
    STU 2.2 v1.0
    Templates changed from STU 2.1 (Listed below with new versions):
        - Document-level templates:
             - QRDA Category III Report V5   
                     * Changed templateId extension (version date) to 2019-02-01
                     * Removed conformance 3338-20954, 3338-18308 from participant (DEV) associatedEntity
                     * Added new conformance 4408-18304 in participant (DEV) associatedEntity
                     * Added new conformances 4408-21399, 4408-21402, 4408-21397 for participant (LOC) associatedEntity
        
        - Section-level templates:
             - Imporvement Activity Section V3  
                     * Changed templateId extension (version date) to 2019-02-01
                     * Section must include Improvement Activity Performed Measure Reference and Results V2 (updated from V1)
                     * Changed test for entry from required "SHALL such that" (4408-21447) to not required "MAY such that" (4408-21450)
             - QRDA Category III Measure Section V5 
                     * Changed templateId extension (version date) to 2019-02-01
                     * Section must include Measure Reference and Results V4 (updated from V3)
                     * Changed conformance 3338-21445 "SHALL", required, to 4408-21445 "MAY", not required
        
        - Entry-level templates:
             - Improvement Activity Performed Measure Reference and Results V2 
                     * Changed templateId extension (version date) to 2019-02-01
                     * New "MAY" conformance 4408-21453, so not schematron addition needed.
                     
             - Measure Data V4 
                     * Changed templateId extension (version date) to 2019-02-01
                     * Made conformance 4408-18241 its own conformance assertion rather that being part of the 4408-18239 "such that" clause
                     * New conformance 4408-18258 "If this reference is to an eCQM, this id SHALL equal the id defined in the corresponding eCQM population criteria section (CONF:4408-18258). "
                           cannot be tested via schematron.
        
    Note:  Templates of type "ACI ..." and "Advancing Care Information ..." have been renamed to "Promoting Interoperability ..." in STU 2.2.
    
    </fileHeader>

    <errorsHeader>ERROR Patterns and Assertions</errorsHeader>
    <warningsHeader>WARNING Patterns and Assertions</warningsHeader>
    
    <mergeReportFilename>c:/Development/QRDA-git/qrda/Schematrons/HL7 QRDA Category III/STU 2.2/mergeReport.txt</mergeReportFilename>
    
    <vocabFilename>c:/Development/QRDA-git/qrda/Schematrons/HL7 QRDA Category III/Vocabulary/voc.xml</vocabFilename>
    
    <!-- All schematrons expected to be under a single main directory -->
    <sourceMainDirectory>
        c:/Development/QRDA-git/qrda/Schematrons/
    </sourceMainDirectory>
    
    <!-- Specify the schematrons to use in the merge below, separated by the templates found in each of the source directories listed. -->
    <!--    Note that the directoryName tags refer to directories relative to the sourceMainDirectory tag, above. -->
    <!--    selector='all' means use all the schematron subdirectories found under directoryName, except for those listed in the 'exclude' tags. -->
    <!--    selector='some' means only use the directoryName subdirectories listed in the 'include' tags --> 

    <sourceDirectory selector='some'>
        <directoryName>HL7 QRDA Category III/Templates</directoryName>
           <!-- Document templates -->
           <include>QRDA Category III Report V5</include>                                     <!-- Changed from 2.1 -->
           <!-- Section templates -->
           <include>Improvement Activity Section V3</include>                                 <!-- Changed from 2.1 -->
           <include>Promoting Interoperability Section V2</include>                           <!-- Renamed from Advancing Care Information Section V2 -->
           <include>QRDA Category III Measure Section V5</include>                            <!-- Changed from 2.1 -->
           <include>QRDA Category III Reporting Parameters Section</include>
           <!-- Entry templates -->
           <include>Aggregate Count</include> 
           <include>Continuous Variable Measure Value</include>
           <include>Ethnicity Supplemental Data Element V2</include>
           <include>Improvement Activity Performed Measure Reference and Results V2</include> <!-- Changed from 2.1 -->
           <include>Measure Data V4</include>                                                 <!-- Changed from 2.1 -->
           <include>Measure Performed</include>
           <include>Measure Reference</include>
           <include>Measure Reference and Results V3</include>
           <include>Payer Supplemental Data Element V2</include>
           <include>Performance Rate</include>
           <include>Performance Rate for Proportion Measure V2</include>
           <include>Postal Code Supplemental Data Element V2</include>
           <!-- Promoting Interoperability templates, below are simply re-named ACI templates. -->
           <include>Promoting Interoperability Measure Performed Measure Reference and Results</include>
           <include>Promoting Interoperability Numerator Denominator Type Measure Denominator Data</include>
           <include>Promoting Interoperability Numerator Denominator Type Measure Numerator Data</include>
           <include>Promoting Interoperability Numerator Denominator Type Measure Reference and Results V2</include>
           <include>Race Supplemental Data Element V2</include>
           <include>Reporting Rate for Proportion Measure</include>
           <include>Reporting Stratum</include>
           <include>Service Encounter</include>
           <include>Sex Supplemental Data Element V3</include>
           <!-- ACI templates removed, replaced with exact copies but renamed as Promoting Interopability, above -->
           <!-- 
               <include>ACI Measure Performed Measure Reference and Results</include>
               <include>ACI Numerator Denominator Type Measure Denominator Data</include>
               <include>ACI Numerator Denominator Type Measure Numerator Data</include>
               <include>ACI Numerator Denominator Type Measure Reference and Results V2</include>
           -->
        
     </sourceDirectory>

    <sourceDirectory selector='some'> 
        <directoryName>HL7 QRDA Category I/Templates</directoryName>
            <!-- Section templates -->
            <include>Measure Section</include>
            <include>Reporting Parameters Section</include>
            <!-- Entry templates -->
            <include>Reporting Parameters Act</include>
        
    </sourceDirectory>
    
</mergeProfile>
